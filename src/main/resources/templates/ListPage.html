<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="Keywords" content="" />
    <meta name="Description" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <meta
      name="viewport"
      content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="browsermode" content="application" />
    <meta name="x5-page-mode" content="app" />
    <title>Pose management</title>
    <link rel="stylesheet" href="front/css/style.css" />
    <link rel="stylesheet" href="front/script/jPicker/css/jPicker-1.1.6.min.css"/>
    <link rel="stylesheet" href="front/script/jPicker/jPicker.css"/>
    <script type="text/javascript" src="front/script/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="front/script/jPicker/jpicker-1.1.6.js"></script>
    <script type="text/javascript" src="front/js/list.js"></script>
    <script type="text/javascript" src="front/js/color.js"></script>

  </head>
  <body class="body">
    <div class="header">
      <div class="header-inner clearfix">
        <div class="logo-box"><div class="logo"></div></div>
        <div class="login-box">
          <a href="/logout" class="icon-login"> <em></em> <span>Logout</span> </a>
          <a href="#" class="icon-user">
            <em></em> <span th:text="${userName}"></span>
          </a>
        </div>
      </div>
    </div>

    <div class="content">
      <div class="content-inner">
        <div class="setting-box clearfix">
          <a href="#" class="btn-setting"><em></em>Setting</a>
          <div class="pop-setting">
            <ul class="setting-list">
              <li><a href="#" onclick="addEquipment()">Add Equipment</a></li>
              <li><a href="#">Import Equipment List</a></li>
              <li><a href="#">User Management</a></li>
            </ul>
          </div>
        </div>
        <div class="table-list">
          <div class="table-title"><h4>DeviceList</h4></div>
          <div class="table-box">
            <table
              class="table-detail"
              width="100%"
              cellpadding="0"
              cellspacing="0"
            >
              <tr>
                <th width="150">Club</th>
                <th>Resource ID</th>
                <th>OutputDevice ID</th>
                <th></th>
              </tr>
              <tr th:each=" store: ${storeInfos}">
                <td th:text="${store.storeId}"></td>
                <td th:text="${store.sitResourceId}"></td>
                <td th:text="${store.storeName}"></td>
                <td>
                  <a href="#" class="setting"><em></em>Setting</a>
                </td>
              </tr>

            </table>

            <div class="add-box"><a href="#" class="btn-add"></a></div>
          </div>
        </div>
        <div class="table-list">
          <div class="table-title"><h4>AlertList</h4></div>
          <div class="table-box">
            <table
              class="table-detail"
              width="100%"
              cellpadding="0"
              cellspacing="0"
            >
              <tr>
                <th width="150">Time</th>
                <th>Club</th>
                <th>ResourseID</th>
                <th></th>
              </tr>
              <tr th:each="alert:${alertInfos}">
                <td th:text="${alert.time}"></td>
                <td th:text="${alert.storeId}"></td>
                <td th:text="${alert.cameraId}"></td>
                <td><img th:src="${alert.image}" style="width: 100px;height: 50px"/></td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="dialog_overlay"></div>
    <input type="hidden" id="color_min" value="173,100,96">
    <input type="hidden" id="color_max" value="173,100,96">
    <div class="add-detail">
        <div class="div_colorpicker" ></div>
        <div class="detail-title">
          <h5>ParameterOfModelList</h5>
          <a href="#" class="btn-close"></a>
        </div>
        <div class="detail-box">
          <ul class="detail-list">
            <li>
              CameraId
              <div class="right-option"><input id="cameraId" name="cameraId" type="text" placeholder="请输入摄相头id"></div>
            </li>
            <li>
              ColorReference
              <div class="right-option"><button id="colorpicker_min" class="colorpicker"></button><button class="colorpicker" id="colorpicker_max"></button></div>
            </li>
            <li>
              Threshold
              <div class="right-option"></div>
            </li>
            <li>
              VideoFPS
              <div class="right-option">
                <div class="select-wrap select-fps">
                  <select name="video_fps" id="video_fps">
                    <option value="0">15</option>
                    <option value="1">10</option>
                    <option value="2">5</option>
                  </select>
                </div>
              </div>
            </li>
            <li>
              VedioResolution
              <div class="right-option">
                <div class="select-wrap select-resolution">
                  <select name="resolution" id="resolution">
                    <option value="0">1024 x 768</option>
                    <option value="1">1024 x 768</option>
                    <option value="2">1024 x 768</option>
                  </select>
                </div>
              </div>
            </li>
            <li>
              Compression ratio
              <div class="right-option">
                <div class="select-wrap select-ratio">
                  <select name="compression-ratio" class="compression_ratio">
                    <option value="0">0.8</option>
                    <option value="1">0.5</option>
                    <option value="2">0.3</option>
                  </select>
                </div>
              </div>
            </li>
            <!--<li>-->
              <!--VideoROI-->
              <!--<div class="right-option"></div>-->
            <!--</li>-->
            <!--<li>-->
              <!--OutputDevice-->
              <!--<div class="right-option">-->
                <!--<div class="select-wrap select-device">-->
                  <!--<select name="device" id="device">-->
                    <!--<option value="0">Device 1</option>-->
                    <!--<option value="1">Device 2</option>-->
                    <!--<option value="2">Device 3</option>-->
                  <!--</select>-->
                <!--</div>-->
              <!--</div>-->
            <!--</li>-->
          </ul>
        </div>
      <div class="result_div" >Error message</div>
        <div class="btn-box">
          <a href="#" class="btn-confirm">Confirm</a>
        </div>
      </div>
    <script type="text/javascript">
      //btn-setting
      $(".setting-box .btn-setting").hover(
        function() {
          $(this).addClass("active");
          $(".pop-setting").fadeIn(300);
        },
        function() {
          $(this).removeClass("active");
          setTimeout(function() {
            $(".pop-setting").is(":visible") && $(".pop-setting").hasClass("on")
              ? ""
              : $(".pop-setting").hide();
          }, 400);
        }
      );

      $(".pop-setting").hover(
        function() {
          $(this).addClass("on");
          $(".setting-box .btn-setting").addClass("active");
        },
        function() {
          $(".setting-box .btn-setting").removeClass("active");
          $(this) .removeClass("on") .hide();
        }
      );

      //btn-add
      $(".table-list .table-box .add-box .btn-add").click(function() {
        $(".dialog_overlay").show();
        $(".add-detail").css("display", "block");
        setTimeout(
          "$('.add-detail').css({'opacity':'1', '-webkit-transform':'scale(1)'})",
          50
        );
      });

      $(".detail-title .btn-close").click(function() {
        $(".dialog_overlay").hide();
        $(".add-detail").css({
          opacity: "0",
          "-webkit-transform": "scale(0)",
          display: "none"
        });
      });
      $("#colorpicker_min").click(function () {
          var LiveCallbackButton = $('#colorpicker_min');
          $(".div_colorpicker").jPicker(
              {},
              //ok
              function(color, context)
              {
                  var all = color.val('all');
                  var sColor=all && '#' + all.hex || 'none';
                  var color_min="["+all.h+","+all.s+","+all.v+"]"
                  alert(color_min)
                  $("#color_min").val(color_min)
                  LiveCallbackButton.css({backgroundColor:sColor});
                  $('#Commit').css(
                      {
                          backgroundColor: all && '#' + all.hex || 'transparent'
                      });
              },
              {},
              //cancel
              function(color, context)
              {
                  $(".div_colorpicker").hide()
              }
      );
      })
      $("#colorpicker_max").click(function () {
          var LiveCallbackButton = $('#colorpicker_max');
          $(".div_colorpicker").jPicker(
              {},
              //ok
              function(color, context)
              {
                  var all = color.val('all');

                  var color=all && '#' + all.hex || 'none';
                  LiveCallbackButton.css({backgroundColor:color});
                  var color_max="["+all.h+","+all.s+","+all.v+"]"
                  alert(color_max)
                  $("#color_max").val(color_max)
                  $('#Commit').css(
                      {
                          backgroundColor: all && '#' + all.hex || 'transparent'
                      });
                  $(".div_colorpicker").hide();
              },
              {},
              //cancel
              function(color, context)
              {
                  $(".div_colorpicker").hide()
              }
      );
      })
      $(".btn-confirm").click(function () {
          var cameraId=$("#cameraId").val()
          var colorMin=$("#color_min").val()
          var colorMax=$("#color_max").val()
          var vedioFps=$(".select-fps").find("option:selected").text();
          var compressionRatio=$(".compression_ratio").find("option:selected").text();

          var url="/setting"
          $.ajax({
              type: "post",
              url: url,
              data: {
                  cameraId:cameraId,
                  vedioFps:vedioFps,
                  compressionRatio:compressionRatio,
                  colorMin:colorMin,
                  colorMax:colorMax
              },
              dataType: "json",
              success: function (result)
              {
                  $(".result_div").css("display","block")
                  if(result.status=="0"){
                      $(".result_div").css("color","#2edd57");
                  }else{
                      $(".result_div").css("color","#ff0000");
                  }
                  $(".result_div").text(result.message)
                  timeout()
              },
              error:function (XMLHttpRequest, textStatus, errorThrown)
              {
                  $(".result_div").css("display","block")
                  $(".result_div").css("color","#ff0000");
                  $(".result_div").text(errorThrown)
                  timeout()
              }
          })

      })
      function timeout() {
          setTimeout(function () {
              $(".result_div").css("display","none")
          },2000)
      }
    </script>
  </body>
</html>
